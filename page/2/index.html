<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<title>joshua poehls | silent thought</title>

<link rel="canonical" href="http://joshua.poehls.me/">
<link href="/feed.xml" rel="alternate" type="application/atom+xml" title="joshua poehls | silent thought">
<meta name="generator" content="Hugo 0.13" />


<link rel="stylesheet" href="/normalize.css">
<link rel="stylesheet" href="/skeleton.css">
<link rel="stylesheet" href="/styles.css">


<link href='http://fonts.googleapis.com/css?family=Merriweather' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>


<meta name="viewport" content="width=device-width, initial-scale=1">


<link rel="apple-touch-icon" href="/touch-icon-iphone.png" /> 
<link rel="apple-touch-icon" sizes="76x76" href="/touch-icon-ipad.png" /> 
<link rel="apple-touch-icon" sizes="120x120" href="/touch-icon-iphone-retina.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/touch-icon-ipad-retina.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/touch-icon-iphone-retinahd.png">

</head>
<body lang="en-US">

<header id="masthead">
	<div class="container">
		<div class="row">
			<div class="twelve columns">
				<h1>
					<small>I am</small>
					<a href="/">Joshua Poehls</a>.
					<small class="contact-link"><a href="/contact">Say hello</a></small>
					<small class="archives-link"><a href="/archives">Archives</a></small>
					<span class="aka">(not so) silent thoughts</span>
				</h1>
			</div>
		</div>
	</div>
</header>



<div class="container">

	<section id="posts">
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2014/09/hello-world">Hello World</a>
            
        </h1>
        <p>
            <time datetime="2014-09-25 09:58:59 -0500 CDT" pubdate="pubdate">Thu, Sep 25, 2014</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2014/09/hello-world">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2014/09/hello-world</span>
            </a>
        </p>
    </header>

    <p>Welcome to my new blog! <sup class="footnote-ref" id="fnref:aa77bbfd89a7b0ff10def205b9c08d51:fn1"><a rel="footnote" href="#fn:aa77bbfd89a7b0ff10def205b9c08d51:fn1">1</a></sup> All of my blogging in the past has been in the form of longer articles, mostly technology related, and mostly trying to teach a tip or trick.</p>

<p>I&rsquo;m taking a different approach this time. I&rsquo;ll be posting more random thoughts.
Sharing articles I find interesting. Overall I expect this to feel more like reading my Facebook wall and that&rsquo;s what I&rsquo;m going for. <sup class="footnote-ref" id="fnref:aa77bbfd89a7b0ff10def205b9c08d51:fn2"><a rel="footnote" href="#fn:aa77bbfd89a7b0ff10def205b9c08d51:fn2">2</a></sup></p>

<p>Here goes nothing!</p>

<table border="0" width="100%" style="font-size: 1.5em" class="noborder">
<tr>
<td>Hello World!</td>
<td style="text-align: center;">Hallo Welt!</td>
<td style="text-align: right; direction: rtl;">שלום עולם</td>
</tr>
</table>
<div class="footnotes">

<hr />

<ol>
<li id="fn:aa77bbfd89a7b0ff10def205b9c08d51:fn1">This is no longer the first post as I&rsquo;ve started migrating older content from my blog at <code>zduck.com</code>.
 <a class="footnote-return" href="#fnref:aa77bbfd89a7b0ff10def205b9c08d51:fn1">↩</a></li>
<li id="fn:aa77bbfd89a7b0ff10def205b9c08d51:fn2">This is my plan to take control of my public content. I&rsquo;ll still share on Facebook and Twitter, but I want to own the canonical version.
 <a class="footnote-return" href="#fnref:aa77bbfd89a7b0ff10def205b9c08d51:fn2">↩</a></li>
</ol>
</div>


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2014/04/go-101-string-or-byte-slice">Go 101: String or Byte Slice?</a>
            
        </h1>
        <p>
            <time datetime="2014-04-16 09:58:59 -0500 CDT" pubdate="pubdate">Wed, Apr 16, 2014</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2014/04/go-101-string-or-byte-slice">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2014/04/go-101-string-or-byte-slice</span>
            </a>
        </p>
    </header>

    

<p>One of the first things you&rsquo;ll notice in Go is that two different types are commonly used for representing text. <code>string</code> and <code>[]byte</code>. A quick example is the <a href="http://golang.org/pkg/regexp/#Regexp.FindAll">regexp package</a> which has functions for both <code>string</code> and <code>[]byte</code>.</p>

<h2 id="what-is-the-difference:c3d0e20736b8b30967b0a5298a41fdb7">What is the difference?</h2>

<p><code>string</code> is immutable and <code>[]byte</code> is mutable. Both can contain arbitrary bytes.</p>

<p>The name &ldquo;string&rdquo; implies unicode text but this is not enforced. Operating on <code>string</code> is like operating on <code>[]byte</code>. You are working with bytes not characters.</p>

<p>They are nearly identical and differ only in mutability. The <a href="http://golang.org/pkg/strings/"><code>strings</code></a> and <a href="http://golang.org/pkg/bytes/"><code>bytes</code></a> packages are nearly identical apart from the type that they use.</p>

<blockquote>
<p><strong>Q:</strong> If strings are just arbitrary bytes, then how do you work with characters?</p>

<p><strong>A:</strong> What you are thinking of as a character, Go calls a <a href="http://golang.org/ref/spec#Rune_literals">rune</a>. One way to iterate the characters in a string is to use the <code>for...range</code> loop. Range will parse the string as UTF-8 and iterate the runes. Read <a href="http://golang.org/doc/effective_go.html#for">the <code>for</code> loop</a> section of Effective Go for more information.</p>
</blockquote>

<h2 id="when-to-use-string:c3d0e20736b8b30967b0a5298a41fdb7">When to use <code>string</code>?</h2>

<p>Ask not when to use <code>string</code> but rather, when to use <code>[]byte</code>. Always start with <code>string</code> and switch to <code>[]byte</code> when justified.</p>

<h2 id="when-to-use-byte:c3d0e20736b8b30967b0a5298a41fdb7">When to use <code>[]byte</code>?</h2>

<p>Use <code>[]byte</code> when you need to make many changes to a string. Since <code>string</code> is immutable, any change will allocate a new <code>string</code>. You can get better performance by using <code>[]byte</code> and avoiding the allocations.</p>

<blockquote>
<p>C# perspective: <code>[]byte</code> is to <a href="http://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.110).aspx"><code>System.StringBuilder</code></a> as <code>string</code> is to <a href="http://msdn.microsoft.com/en-us/library/system.string(v=vs.110).aspx"><code>System.String</code></a> when it comes to performance.</p>
</blockquote>

<p>Even if your code isn&rsquo;t directly manipulating the string, you may want to use <code>[]byte</code> if you are using packages which require it so you can avoid the conversion.</p>

<p>Converting to and from <code>[]byte</code> is easy. Just remember that each conversion creates a copy of the value.</p>

<pre><code>s := &quot;some string&quot;
b := []byte(s) // convert string -&gt; []byte
s2 := string(b) // convert []byte -&gt; string
</code></pre>

<blockquote>
<p>Converting to/from <code>string</code> and <code>[]byte</code> copies the entire value. Using lots of type conversions in your code is typically a warning sign that you need to reevaluate the types you are using. You want to minimize conversions both for performance and clean code.</p>
</blockquote>

<h2 id="more-about-strings:c3d0e20736b8b30967b0a5298a41fdb7">More about strings</h2>

<p>The Go blog has posted in detail about <a href="http://blog.golang.org/strings">strings, bytes, runes, and characters in Go</a>. You should definitely read that post to fully understand the topic.</p>

<p><strong>Update:</strong> Thanks to <a href="https://twitter.com/mholt6">@mholt6</a> for reviewing the post and helping improve it!</p>


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2014/04/go-101-methods-on-pointers-vs-values">Go 101: Methods on Pointers vs. Values</a>
            
        </h1>
        <p>
            <time datetime="2014-04-14 09:58:59 -0500 CDT" pubdate="pubdate">Mon, Apr 14, 2014</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2014/04/go-101-methods-on-pointers-vs-values">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2014/04/go-101-methods-on-pointers-vs-values</span>
            </a>
        </p>
    </header>

    <p>Methods can be declared on both pointers and values. The difference is subtle but important.</p>

<pre><code>type Person struct {
     age int
}

// Method's receiver is the value, `Person`.
func (p Person) Age() int {
     return p.age
}

// Method's receiver is a pointer, `*Person`.
func (p *Person) SetAge(age int) {
     p.age = age
}
</code></pre>

<blockquote>
<p>In reality, you&rsquo;d only define getter and setter functions like this if you needed to implement additional logic. In an example like this you&rsquo;d just make the <code>Age</code> field public.</p>
</blockquote>

<p>This is how you define getter and setter functions in Go. Notice that we defined the <code>Age()</code> function on the value but <code>SetAge()</code> on the pointer (i.e. <code>*Person</code>). This is important.</p>

<p><strong>Go always passes by value.</strong> Function parameters are  always passed by copying them as opposed to passing a reference. (<a href="http://golang.org/doc/faq#pass_by_value">Read more.</a>)</p>

<blockquote>
<p>Even pointers are technically passed by value. The memory address is copied, the value it points to is <em>not</em> copied.</p>
</blockquote>

<p>Here is the <em>wrong</em> way to define <code>SetAge</code>. Let&rsquo;s see what happens.</p>

<pre><code>func (p Person) SetAge(age int) {
     p.age = age
}

p := Person{}
p.SetAge(10)
fmt.Printf(&quot;Age: %v&quot;, p.Age()) // Age: 0
</code></pre>

<p><a href="http://play.golang.org/p/CJZfqBrAIC">&#9654; Run it.</a></p>

<p>Notice that the output is <code>0</code> instead of <code>10</code>? This is &lsquo;pass by value&rsquo; in action.</p>

<p>Calling <code>p.SetAge(10)</code> passes a copy of <code>p</code> to the <code>SetAge</code> function. <code>SetAge</code> sets the <code>age</code> property on the copy of <code>p</code> that it received which is discarded after the function returns.</p>

<p>Now let&rsquo;s do it the right way.</p>

<pre><code>func (p *Person) SetAge(age int) {
     p.age = age
}

p := Person{}
p.SetAge(10)
fmt.Printf(&quot;Age: %v&quot;, p.Age()) // Age: 10
</code></pre>

<p><a href="http://play.golang.org/p/BbIlSUQBCr">&#9654; Run it.</a></p>

<p>My rule of thumb is this: declare the method on the pointer unless your struct is such that you don&rsquo;t use pointers to it.</p>

<p>Two reasons:</p>

<ol>
<li>Performance. Calling a method on a pointer will almost always be faster than copying the value. There may be cases wear the copy is faster but those are edge case.</li>
<li>Consistency. It is common for at least one of your methods to need a pointer receiver and if any of the type&rsquo;s methods are on the pointer then they all should be. <em>This recommendation is direct from <a href="http://golang.org/doc/faq#methods_on_values_or_pointers">the FAQ</a>.</em></li>
</ol>

<p><a href="http://golang.org/doc/faq#methods_on_values_or_pointers">Read the FAQ</a> &ldquo;Should I define methods on values or pointers?&rdquo; for more insight.</p>

<p><strong>Update:</strong> Thanks to the fine folks on reddit for suggesting some improvements.<br />
<a href="http://www.reddit.com/r/golang/comments/23060m/go_101_methods_on_pointers_vs_values/">Join the discussion on reddit!</a></p>

<p><strong>Update 2:</strong> Here are <a href="https://github.com/golang/go/wiki/CodeReviewComments#receiver-type">even more rules of thumb</a> to help you choose whether to use a value or pointer receiver.</p>


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2014/04/go-conventions-constructors-and-overloads">Go 101: Constructors and Overloads</a>
            
        </h1>
        <p>
            <time datetime="2014-04-11 09:58:59 -0500 CDT" pubdate="pubdate">Fri, Apr 11, 2014</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2014/04/go-conventions-constructors-and-overloads">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2014/04/go-conventions-constructors-and-overloads</span>
            </a>
        </p>
    </header>

    <p>Go doesn&rsquo;t have constructors in the traditional sense. The convention is to make the zero value useful whenever possible.</p>

<pre><code>type Person struct {
     Age int
}

// These are equivalent.
// `p1` and `p2` are initialized to the zero value of Person.
// Neither of these are nil.
var p1 Person // type Person
p2 := Person{} // type Person

// You could also use `new` to allocate which returns a pointer
p3 := new(Person) // type *Person
</code></pre>

<blockquote>
<p>It is most common to use the struct initializer. e.g. <code>p := Person{}</code> or <code>p := &amp;Person{}</code> if you need the pointer.</p>
</blockquote>

<p>Sometimes you want special initialization logic. If your type is named <code>Person</code> then the convention would be create a function named <code>NewPerson</code> that returns a pointer to an initialized <code>Person</code> type.</p>

<pre><code>func NewPerson(int age) *Person {
     p := Person{age}
     return &amp;p
}

myPerson := NewPerson(10) // type *Person
</code></pre>

<p>Multiple constructors can be implemented by having multiple initializer functions. Go doesn&rsquo;t support function overloads so you will need to name your functions intelligently.</p>

<pre><code>import &quot;time&quot;

func NewPersonAge(int age) *Person {
     p := Person{age}
     return &amp;p
}

func NewPersonBirthYear(int birthYear) *Person {
     p := Person{time.Now().Year() - birthYear}
     return &amp;p
}
</code></pre>

<p><a href="http://golang.org/doc/effective_go.html#composite_literals">Read more</a> in Effective Go.</p>

<p><strong>Update:</strong> Thanks to Joe Shaw for the comments! I&rsquo;ve updated the article with his suggestions.</p>


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/powershell-script-module-boilerplate">PowerShell Script Module Boilerplate</a>
            
        </h1>
        <p>
            <time datetime="2013-12-21 10:43:31 -0600 CST" pubdate="pubdate">Sat, Dec 21, 2013</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/powershell-script-module-boilerplate">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/powershell-script-module-boilerplate</span>
            </a>
        </p>
    </header>

    

<p>One of the things I always look for when getting familiar with a new language or environment is examples of the physical file structure and logical organization of the code. How do you layout your project files? What is idiomatic?</p>

<p>Unsurprisingly, this isn&rsquo;t always as simple as finding a few open-source projects on GitHub to reference. Believe it or not, there are a lot of pretty unorganized coders out there. I admit to being a bit OCD with my project structures. I like them clean, organized, and consistent.</p>

<p>In this post I&rsquo;m going to cover my preferred boilerplate for <a href="http://msdn.microsoft.com/en-us/library/dd878340(v=vs.85).aspx">PowerShell Script Modules</a>.</p>

<p>Script Modules are about as simple as it gets. Typically you have one or more PS1 or PSM1 files that contain your module&rsquo;s cmdlets. Beyond that you <em>should</em> have a <a href="http://msdn.microsoft.com/en-us/library/dd878337(v=vs.85).aspx">PSD1 manifest</a>.</p>

<h2 id="fork-this:bf50e637665b449b2d775f5a8ffeb5fd">Fork this!</h2>

<p>This entire boilerplate <a href="http://github.com/jpoehls/powershell-script-module-boilerplate">is on GitHub</a>. If you just want a solid starting point, download this repo. If you want to know more, keep reading.</p>

<h2 id="file-structure:bf50e637665b449b2d775f5a8ffeb5fd">File Structure</h2>

<pre><code>+- src/
| +- source_file.ps1
| +- ...
+- tools/
| +- release.ps1
+- LICENSE
+- README.md
</code></pre>

<ul>
<li><code>src/</code> contains the PS1, PSM1, PS1XML, and any other source files for the module.</li>
<li><code>tools/</code> is where I put any meta scripts for the project. Usually there is just one script here that builds a release version of my module.</li>
<li><code>LICENSE</code> - if your module is open-source, always specify what license you are releasing it under.</li>
<li><code>README.md</code> - always have a README file. Even if it is only a one sentence description. <a href="http://daringfireball.net/projects/markdown/">Markdown</a> is a great format to use for this.</li>
</ul>

<h2 id="explicit-exports:bf50e637665b449b2d775f5a8ffeb5fd">Explicit Exports</h2>

<p>By default, PowerShell will export all of the functions in your module. I recommend being explicit about this and always specifying which functions should be publically exported. This way it is easy to add private helper functions that are internal to your module without worrying about them being made public accidentally.</p>

<p>You do this by calling <a href="http://technet.microsoft.com/en-us/library/hh849736.aspx"><code>Export-ModuleMember</code></a> at the bottom of your source file. If you have a <code>source.psm1</code> file that contains a <code>Show-Calendar</code> function that should be public, you would do something like this:</p>

<pre><code># Show-Calendar.ps1
#
# Show-Calendar will be public.
# Any other functions in this file will be private.

function Show-Calendar {
    # ...
}

Export-ModuleMember -Function Show-Calendar
</code></pre>

<p><a href="http://msdn.microsoft.com/en-us/library/dd878340(v=vs.85).aspx">Full example &#8594;</a></p>

<h2 id="release-script:bf50e637665b449b2d775f5a8ffeb5fd">Release Script</h2>

<p><strong>Every project should have a release script.</strong> You should never be manually building your distributable release. At a minimum my release script will:</p>

<ol>
<li>Generate the PSD1 manifest for my module.</li>
<li>Save the manifest into a temporary <code>./dist</code> folder.</li>
<li>Copy all of the module source files into <code>./dist</code>.</li>
<li>Add all of the module&rsquo;s source files to a ZIP file ready for me to distribute.</li>
</ol>

<p>Here is what a simple <code>release.ps1</code> script might look like.</p>

<p><a href="https://github.com/jpoehls/powershell-script-module-boilerplate/blob/master/tools/release.ps1">View on GitHub &#8594;</a></p>

<pre><code>&lt;#
.SYNOPSIS
    Generates a manifest for the module
    and bundles all of the module source files
    and manifest into a distributable ZIP file.
#&gt;

[CmdletBinding()]
param(
    [Parameter(Mandatory = $true)]
    [version]$ModuleVersion
)

$ErrorActionPreference = &quot;Stop&quot;

Write-Host &quot;Building release for v$moduleVersion&quot;

$scriptPath = Split-Path -LiteralPath $(if ($PSVersionTable.PSVersion.Major -ge 3) { $PSCommandPath } else { &amp; { $MyInvocation.ScriptName } })

$src = (Join-Path (Split-Path $scriptPath) 'src')
$dist = (Join-Path (Split-Path $scriptPath) 'dist')
if (Test-Path $dist) {
    Remove-Item $dist -Force -Recurse
}
New-Item $dist -ItemType Directory | Out-Null

Write-Host &quot;Creating module manifest...&quot;

$manifestFileName = Join-Path $dist 'YourModule.psd1'

# TODO: Tweak the manifest to fit your module's needs.
New-ModuleManifest `
    -Path $manifestFileName `
    -ModuleVersion $ModuleVersion `
    -Guid fe524c79-95a6-4d02-8e15-30dddeb8c874 `
    -Author 'Your Name' `
    -CompanyName 'Your Company' `
    -Copyright '(c) $((Get-Date).Year) Your Company. All rights reserved.' `
    -Description 'Description of your module.' `
    -PowerShellVersion '3.0' `
    -DotNetFrameworkVersion '4.5' `
    -NestedModules (Get-ChildItem $src -Exclude *.psd1 | % { $_.Name })

Write-Host &quot;Creating release archive...&quot;

# Copy the distributable files to the dist folder.
Copy-Item -Path &quot;$src\*&quot; `
          -Destination $dist `
          -Recurse

# Requires .NET 4.5
[Reflection.Assembly]::LoadWithPartialName(&quot;System.IO.Compression.FileSystem&quot;) | Out-Null

$zipFileName = Join-Path ([System.IO.Path]::GetDirectoryName($dist)) &quot;$([System.IO.Path]::GetFileNameWithoutExtension($manifestFileName))-$ModuleVersion.zip&quot;

# Overwrite the ZIP if it already already exists.
if (Test-Path $zipFileName) {
    Remove-Item $zipFileName -Force
}

$compressionLevel = [System.IO.Compression.CompressionLevel]::Optimal
$includeBaseDirectory = $false
[System.IO.Compression.ZipFile]::CreateFromDirectory($dist, $zipFileName, $compressionLevel, $includeBaseDirectory)

Move-Item $zipFileName $dist -Force
</code></pre>

<h2 id="version-control:bf50e637665b449b2d775f5a8ffeb5fd">Version Control</h2>

<p>Always exclude your <code>./dist</code> folder from source control. As a rule of thumb, you never want to store the build output of any project in source control.</p>

<p>Depending on how you plan to release your module, you may prefer to exclude <code>*.psd1</code> manifest files from source control. This just keeps things clean and enforces that you use your release script to build the distributable.</p>

<h2 id="good-examples:bf50e637665b449b2d775f5a8ffeb5fd">Good Examples</h2>

<p>Here are a few open-source PowerShell modules that I&rsquo;ve found to be good examples to follow.</p>

<ul>
<li><a href="https://github.com/adamdriscoll/PoshInternals">PoshInternals</a> by Adam Driscoll</li>
<li><a href="https://github.com/psake/psake">Psake</a> by James Kovacs</li>
<li><a href="https://github.com/jpoehls/poshato">Poshato</a></li>
</ul>

<!--
## Binary Modules

I use a very similar file structure for [PowerShell Binary Modules][binary_module] but they do introduce more complexity into the release script. I'll be covering my binary module boilerplate in a future post. 
-->


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/powershell-batch-file-wrapper">PowerShell Batch File Wrapper</a>
            
        </h1>
        <p>
            <time datetime="2013-12-18 10:43:31 -0600 CST" pubdate="pubdate">Wed, Dec 18, 2013</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/powershell-batch-file-wrapper">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/powershell-batch-file-wrapper</span>
            </a>
        </p>
    </header>

    

<p>Sometimes you want a <code>.cmd</code> wrapper for your PowerShell script. Usually for me this is so people who aren&rsquo;t familiar with the command line can double-click to execute the script.</p>

<p>This batch file should be saved alongside your PowerShell script, like so.</p>

<pre><code>.\
 |- my_script.ps1
 |- my_script.cmd
</code></pre>

<p><code>my_script.cmd</code> will execute the same named <code>.ps1</code> file in the same directory, so <code>my_script.ps1</code> in this case. Any arguments passed to <code>my_script.cmd</code> will pass-through to the PowerShell script.</p>

<pre><code>@ECHO OFF

SET SCRIPTNAME=%~d0%~p0%~n0.ps1
SET ARGS=%*
IF [%ARGS%] NEQ [] GOTO ESCAPE_ARGS

:POWERSHELL
PowerShell.exe -NoProfile -NonInteractive -NoLogo -ExecutionPolicy Unrestricted -Command &quot;&amp;amp; { $ErrorActionPreference = 'Stop'; &amp;amp; '%SCRIPTNAME%' @args; EXIT $LASTEXITCODE }&quot; %ARGS%
EXIT /B %ERRORLEVEL%

:ESCAPE_ARGS
SET ARGS=%ARGS:&quot;=\&quot;%
SET ARGS=%ARGS:`=``%
SET ARGS=%ARGS:'=`'%
SET ARGS=%ARGS:$=`$%
SET ARGS=%ARGS:&amp;#123;=`&amp;#123;%
SET ARGS=%ARGS:}=`}%
SET ARGS=%ARGS:(=`(%
SET ARGS=%ARGS:)=`)%
SET ARGS=%ARGS:,=`,%
SET ARGS=%ARGS:^%=%

GOTO POWERSHELL
</code></pre>

<h2 id="what-s-going-on-here:7908c9f856e796bbc0d3b5748b45b371">What&rsquo;s going on here?</h2>

<ul>
<li><code>%SCRIPTNAME%</code> variable holds the name of the PowerShell script to execute. <code>%~d0%~p0%~n0</code> magic gets the full path of the
current batch script without the file extension. By specifying the full path of the PowerShell script
like this we can guarantee that it is always executed from the right place
no matter what your working directory is.</li>
<li>Escapes special characters in the arguments so that they are passed to PowerShell as you would expect.</li>
<li>Runs <code>PowerShell.exe</code> with:

<ul>
<li><code>-NoProfile</code> to improve startup performance. Scripts you are distributing
shouldn&rsquo;t rely on anything in your profile anyway.</li>
<li><code>-NonInteractive</code> because usually my scripts don&rsquo;t need input from the user.</li>
<li><code>-ExecutionPolicy Unrestricted</code> to ensure that the PowerShell script can
be executed regardless of the machine&rsquo;s default Execution Policy.</li>
<li><code>-Command</code> syntax for executing the command ensures that PowerShell
returns the correct exit code from your script.
Using <code>-Command</code> with <code>$ErrorActionPreference = 'Stop'</code> also ensures that
errors thrown from your script cause PowerShell.exe to return a failing
exit code (1). <a href="http://zduck.com/2012/powershell-batch-files-exit-codes/">PowerShell is quite buggy when it comes to bubbling exit
codes.</a>
This is the safest method I&rsquo;ve found.</li>
</ul></li>
</ul>

<h2 id="batch-file-tips:7908c9f856e796bbc0d3b5748b45b371">Batch file tips</h2>

<h3 id="special-characters-in-arguments:7908c9f856e796bbc0d3b5748b45b371">Special characters in arguments</h3>

<p>Remember that certain special characters need to be escaped in arguments passed to the batch file. These characters are: <code>^  &amp;  &lt;  &gt;  /?</code>. Note that <code>/?</code> is a sequence and is recognized as a help flag when passed to a batch file.</p>

<blockquote>
<p><code>my_script.cmd &quot;I &quot;&quot;am&quot;&quot; quoted&quot;</code> passes a single argument <code>I &quot;am&quot; quoted</code> to PowerShell.</p>

<p><code>my_script.cmd &quot;^&amp;&lt;&gt;/?&quot;</code> passes <code>^&amp;&lt;&gt;/?</code></p>
</blockquote>

<h3 id="environment-variable-expansion:7908c9f856e796bbc0d3b5748b45b371">Environment variable expansion</h3>

<p>Environment variables get automatically expanded in batch file arguments.</p>

<blockquote>
<p><code>my_script.cmd %PROGRAMFILES%</code> passes <code>C:\Program Files</code></p>
</blockquote>


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/powershell-script-boilerplate">PowerShell Script Boilerplate</a>
            
        </h1>
        <p>
            <time datetime="2013-12-18 10:43:31 -0600 CST" pubdate="pubdate">Wed, Dec 18, 2013</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/powershell-script-boilerplate">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/powershell-script-boilerplate</span>
            </a>
        </p>
    </header>

    

<p>This post is as much for me as it is for you. I write a lot of PowerShell scripts and they tend to follow a certain pattern. This is my personal boilerplate for PowerShell scripts.</p>

<pre><code>Set-StrictMode -Version Latest
$ErrorActionPreference = &quot;Stop&quot;

$scriptDir = Split-Path -LiteralPath $(if ($PSVersionTable.PSVersion.Major -ge 3) { $PSCommandPath } else { &amp; { $MyInvocation.ScriptName } })

$stopwatch = [System.Diagnostics.Stopwatch]::StartNew()

try
{
    # TODO: Insert script here.
}
finally
{
    Write-Output &quot;Done! $($stopwatch.Elapsed)&quot;
}
</code></pre>

<h2 id="what-s-going-on-here:469e3590a69ce674428532a2149fa57a">What&rsquo;s going on here?</h2>

<ul>
<li>Enables <code>StrictMode</code> to enforce some best practices. <sup class="footnote-ref" id="fnref:469e3590a69ce674428532a2149fa57a:fn1"><a rel="footnote" href="#fn:469e3590a69ce674428532a2149fa57a:fn1">1</a></sup>

<ul>
<li>Prevents use of variables that have not been initialized.</li>
<li>Cannot call non-existent properties on objects.</li>
<li>Disallows calling a function like a method, e.g., <code>Do-Something(1 2)</code> instead of <code>Do-Something 1 2</code>.</li>
<li>Prohibits creating variables without a name.</li>
</ul></li>
<li>Sets <code>$ErrorActionPreference</code> so that unhandled exceptions will halt
the script execution. By default, PowerShell will roll on when an exceptions
is thrown and this statement makes my scripts safe by default.</li>
<li>Set <code>$scriptDir</code> to the directory path of the current script.
This may be different than the working directory.</li>
<li>Most of the time I want to know how long my script takes to run so I include
a <code>$stopwatch</code> that will output the elapsed time when the script finishes.</li>
<li>The <code>try...finally</code> ensures that the elapsed time will output even if the script throws an exception.</li>
</ul>

<blockquote>
<p>Need to wrap your PowerShells script with a batch file? Grab my <a href="/powershell-batch-file-wrapper">PowerShell batch file wrapper</a>.</p>
</blockquote>
<div class="footnotes">

<hr />

<ol>
<li id="fn:469e3590a69ce674428532a2149fa57a:fn1"><a href="http://blogs.technet.com/b/heyscriptingguy/archive/2014/12/03/enforce-better-script-practices-by-using-set-strictmode.aspx">Read more about this</a> on the &ldquo;Hey, Scripting Guy!&rdquo; blog.
 <a class="footnote-return" href="#fnref:469e3590a69ce674428532a2149fa57a:fn1">↩</a></li>
</ol>
</div>


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2012/powershell-script-module-boilerplate">PowerShell, batch files, and exit codes. Recipes &amp; Secrets.</a>
            
        </h1>
        <p>
            <time datetime="2012-06-23 10:43:31 -0600 -0600" pubdate="pubdate">Sat, Jun 23, 2012</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2012/powershell-script-module-boilerplate">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2012/powershell-script-module-boilerplate</span>
            </a>
        </p>
    </header>

    

<h2 id="tl-dr:e436619b3c225495df020f575a03107f">TL;DR;</h2>

<blockquote>
<p><strong>Update:</strong> If you want to save some time, skip reading this and just use my <a href="/powershell-script-boilerplate">PowerShell Script Boilerplate</a>. It includes an excellent batch file wrapper, argument escaping, and error code bubbling.</p>
</blockquote>

<p><code>PowerShell.exe</code> doesn&rsquo;t return correct exit codes when using the <code>-File</code> option. Use <code>-Command</code> instead. <em>(<a href="https://connect.microsoft.com/PowerShell/feedback/details/750653/powershell-exe-doesn-t-return-correct-exit-codes-when-using-the-file-option">Vote for this issue</a> on Microsoft Connect.)</em></p>

<p><a href="#bat-wrapper">This</a> is a batch file wrapper for executing PowerShell scripts. It forwards arguments to PowerShell and correctly bubbles up the exit code (when it can).</p>

<p><code>PowerShell.exe</code> still <a href="#command-parsererror">returns a passing (0) exit code when a <code>ParserError</code> is thrown</a>. Even when using <code>-Command</code>. I haven&rsquo;t found a workaround for this. <em>(<a href="https://connect.microsoft.com/PowerShell/feedback/details/750654/powershell-exe-returns-a-passing-0-exit-code-when-a-parsererror-is-thrown">Vote for this issue</a> on Microsoft Connect.)</em></p>

<p>You can use <a href="#black-magic">black magic</a> to include spaces and quotes in the arguments you pass through the batch file wrapper to PowerShell.</p>

<h2 id="powershell:e436619b3c225495df020f575a03107f">PowerShell</h2>

<p>PowerShell is a great scripting environment, and it is my preferred tool for writing build scripts for .NET apps. Exit codes are vital in build scripts because they are how your Continuous Integration server knows whether the build passed or failed.</p>

<p>This is a <strike>quick</strike> tour of working with exit codes in PowerShell scripts and batch files. I&rsquo;m including batch files because they are often necessary to wrap the execution of your PowerShell scripts.</p>

<p>Let&rsquo;s start easy. Say you need to run a command line app or batch file from your PowerShell script. How can you check the exit code of that process?</p>

<pre data-language="powershell"><code># script.ps1

cmd /C exit 1
Write-Host $LastExitCode    # 1</code></pre>

<p><code>$LastExitCode</code> is a special variable that holds the exit code of the last Windows based program that was run. So says <a href="http://technet.microsoft.com/en-us/library/dd347675.aspx">the documentation</a>.</p>

<p>Remember though, <code>$LastExitCode</code> doesn&rsquo;t do squat for PowerShell commands. Use <code>$?</code> for that.</p>

<pre data-language="powershell"><code># script.ps1

Get-ChildItem "C:\"
Write-Host $?    # True

Get-ChildItem "Z:\some\non-existant\path"
Write-Host $?    # False</code></pre>

<p>Anytime you run an external command like this, you need to check the exit code and throw an exception if needed. Otherwise the PowerShell script will keep right on trucking after a failure.</p>

<pre data-language="powershell"><code># script.ps1

cmd /C exit 1
if ($LastExitCode -ne 0) {
    throw "Command failed with exit code $LastExitCode."
}
Write-Host "You'll never see this."</code></pre>

<p>Writing these assertions all the time will get old. Fortunately you can use a helper function, like this one found in the <a href="http://github.com/psake/psake">excellent psake project</a>.</p>

<pre data-language="powershell"><code># script.ps1

function Exec
{
    [CmdletBinding()]
    param (
        [Parameter(Position=0, Mandatory=1)]
        [scriptblock]$Command,
        [Parameter(Position=1, Mandatory=0)]
        [string]$ErrorMessage = "Execution of command failed.`n$Command"
    )
    &amp; $Command
    if ($LastExitCode -ne 0) {
        throw "Exec: $ErrorMessage"
    }
}

Exec { cmd /C exit 1 }
Write-Host "You'll never see this."</code></pre>

<h3 id="throwing-exit-codes:e436619b3c225495df020f575a03107f">Throwing &amp; exit codes</h3>

<p>The <code>throw</code> keyword is how you generate a terminating error in PowerShell. It will, sometimes, cause your PowerShell script to return a failing exit code (1). Wait, when does it <em>not</em> cause a failing exit code, you ask? This is where PowerShell&rsquo;s warts start to show. Let me demonstrate some scenarios.</p>

<pre data-language="powershell"><code># broken.ps1

throw "I'm broken"</code></pre>

<p><em>From the PowerShell command prompt:</em></p>

<pre><code>PS&gt; .\broken.ps1
<span style="color: red;">I'm broken.
At C:\broken.ps1:1 char:6
+ throw &lt;&lt;&lt;&lt;  "I'm broken."
    + CategoryInfo          : OperationStopped: (I'm broken.:String) [], RuntimeException
    + FullyQualifiedErrorId : I'm broken.</span>
    
PS&gt; $LastExitCode
1</code></pre>

<p><em>From the Windows command prompt:</em></p>

<pre><code>&gt; PowerShell.exe -NoProfile -NonInteractive -ExecutionPolicy unrestricted -Command ".\broken.ps1"
<span style="color: red;">I'm broken.
At C:\broken.ps1:1 char:6
+ throw &lt;&lt;&lt;&lt;  "I'm broken."
    + CategoryInfo          : OperationStopped: (I'm broken.:String) [], RuntimeException
    + FullyQualifiedErrorId : I'm broken.</span>
    
&gt; echo %errorlevel%
1</code></pre>

<p>That worked, too. Good.</p>

<p><em>Again, from the Windows command prompt:</em></p>

<pre><code>&gt; PowerShell.exe -NoProfile -NonInteractive -ExecutionPolicy unrestricted <b>-File</b> ".\broken.ps1"
<span style="color: red;">I'm broken.
At C:\broken.ps1:1 char:6
+ throw &lt;&lt;&lt;&lt;  "I'm broken."
    + CategoryInfo          : OperationStopped: (I'm broken.:String) [], RuntimeException
    + FullyQualifiedErrorId : I'm broken.</span>

&gt; echo %errorlevel%
0</code></pre>

<p>Whoa! We still saw the error, but PowerShell returned a passing exit code. What the heck?! Yes, this is the wart.</p>

<h3 id="a-workaround-for-file:e436619b3c225495df020f575a03107f">A workaround for <code>-File</code></h3>

<p><code>-File</code> allows you to pass in a script for PowerShell to execute, however terminating errors in the script will not cause PowerShell to return a failing exit code. I have no idea why this is the case. If you know why, please share!</p>

<p>A workaround is to add a <code>trap</code> statement to the top of your PowerShell script. (Thanks, Chris Oldwood, for <a href="http://chrisoldwood.blogspot.com/2011/05/powershell-throwing-exceptions-exit.html">pointing this out</a>!)</p>

<pre data-language="powershell"><code># broken.ps1

trap
{
    Write-Error $_
    exit 1
}
throw "I'm broken."</code></pre>

<p><em>From the Windows command prompt:</em></p>

<pre><code>&gt; PowerShell.exe -NoProfile -NonInteractive -ExecutionPolicy unrestricted <b>-File</b> ".\script.ps1"
<span style="color: red;">C:\broken.ps1 : I'm broken.
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,broken.ps1</span>

&gt; echo %errorlevel%
1</code></pre>  

<p>Notice that we got the correct exit code this time, but our error output didn&rsquo;t include as much detail. Specifically, we didn&rsquo;t get the line number of the error like we were getting in the previous tests. So it isn&rsquo;t a perfect workaround.</p>

<p><strong>Remember.</strong> Use <code>-Command</code> instead of <code>-File</code> whenever possible. If for some reason you must use <code>-File</code> or your script needs to support being run that way, then use the trap workaround above.</p>

<p><a id="command-parsererror"> </a></p>

<h3 id="command-can-still-fail:e436619b3c225495df020f575a03107f"><code>-Command</code> can still fail</h3>

<p>I&rsquo;ve discovered that PowerShell will still exit with a success code (0) when a <code>ParserError</code> is thrown. Even when using <code>-Command</code>.</p>

<p><em>From the Windows command prompt:</em></p>

<pre><code>&gt; PowerShell.exe -NoProfile -NonInteractive -Command "Write-Host 'You will never see this.'" <b>"\"</b>
<span style="color: red;">The string starting:
At line:1 char:39
+ Write-Host 'You will never see this.'  &lt;&lt;&lt;&lt; "
is missing the terminator: ".
At line:1 char:40
+ Write-Host 'You will never see this.' " &lt;&lt;&lt;&lt;
    + CategoryInfo          : <b>ParserError</b>: (:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : TerminatorExpectedAtEndOfString</span>

&gt; echo %errorlevel%
0</code></pre>

<p>I&rsquo;m not aware of any workaround for this behavior. This is very disturbing, because these parser errors can be caused by arguments (as I demonstrated above). This means there is no way to guarantee your script will exit with the correct code when it fails.</p>

<p><em>Note: This was tested in PowerShell v2, on Windows 7 (x64).</em></p>

<p>There are <a href="https://connect.microsoft.com/PowerShell/feedback/details/637113/powershell-command-line-exit-codes-inconsistency">other</a> <a href="https://connect.microsoft.com/PowerShell/feedback/details/638771/powershell-return-code-and-parameters">known</a> bugs with PowerShell&rsquo;s exit codes. Beware.</p>

<h2 id="batch-files:e436619b3c225495df020f575a03107f">Batch files</h2>

<p>I mentioned early on that it is often necessary to wrap the execution of your PowerShell script in a batch file. Some common reasons for this might be:</p>

<ul>
<li>You want users of your script to be able to double-click to run it.</li>
<li>Your build runner doesn&rsquo;t support execution of PowerShell scripts directly.</li>
</ul>

<p>Whatever the reason, writing a batch file wrapper for a PowerShell script is easy. You just need to make sure that your batch file properly returns the exit code from PowerShell. Otherwise, your PowerShell script might fail and your batch file would return a successful exit code (0).</p>

<p><a id="bat-wrapper"> </a></p>

<p><del>This is a safe template for you to use. Bookmark it.</del></p>

<blockquote>
<p><strong>Update:</strong> I&rsquo;ve created a <em>much</em> better batch file wrapper for my PowerShell scripts. I recommend you ignore the one below and <strong><a href="/powershell-batch-file-wrapper">use my new one</a></strong> instead.</p>
</blockquote>

<pre data-language="batch"><code>:: script.bat

@ECHO OFF
PowerShell.exe -NoProfile -NonInteractive -ExecutionPolicy unrestricted -Command "&amp; %~d0%~p0%~n0.ps1" %*
EXIT /B %errorlevel%</code></pre>

<p>This wrapper will execute the PowerShell script with the same file name (i.e., <code>script.ps1</code> if the batch file is named <code>script.bat</code>), and then exit with the same code that PowerShell exited with. It will also forward any arguments passed to the batch file, to the PowerShell script.</p>

<p>Let&rsquo;s test it out.</p>

<pre data-language="powershell"><code># script.ps1

param($Arg1, $Arg2)
Write-Host "Arg 1: $Arg1"
Write-Host "Arg 2: $Arg2"</code></pre>

<p><em>From the Windows command prompt:</em></p>

<pre data-language="batch"><code>&gt; script.bat happy scripting
Arg 1: happy
Arg 2: scripting</code></pre>

<p>What if we want &ldquo;happy scripting&rdquo; to be passed as a single argument?</p>

<pre data-language="batch"><code>&gt; script.bat "happy scripting"
Arg 1: happy
Arg 2: scripting</code></pre>

<p><a id="black-magic"> </a></p>

<p>Well that didn&rsquo;t work at all. This is the secret recipe.</p>

<pre data-language="batch"><code>&gt; script.bat "'Happy scripting with single '' and double \" quotes!'"
Arg 1: Happy scripting with single ' and double " quotes!
Arg 2:</code></pre> 

<p>Please don&rsquo;t ask me to explain this black magic, I only know that it works. Much credit to <a href="http://stackoverflow.com/questions/6714165/powershell-stripping-double-quotes-from-command-line-arguments">this StackOverflow question</a> for helping me solve this!</p>

<p>For comparison, here is how you would do it if you were executing the script from PowerShell, without using the batch file wrapper.</p>

<p><em>From the PowerShell command prompt:</em></p>

<pre data-language="batch"><code>PS&gt; .\script.ps1 happy scripting
Arg 1: happy
Arg 2: scripting

PS&gt; .\script.ps1 "Happy scripting with single ' and double `" quotes included!"
Arg 1: Happy scripting with single ' and double " quotes included!
Arg 2: </code></pre>

<p>That&rsquo;s all folks!</p>


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2007/recursively-deleting-files-with-powershell">Recursively deleting files with PowerShell</a>
            
        </h1>
        <p>
            <time datetime="2007-04-23 10:43:31 -0600 -0600" pubdate="pubdate">Mon, Apr 23, 2007</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2007/recursively-deleting-files-with-powershell">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2007/recursively-deleting-files-with-powershell</span>
            </a>
        </p>
    </header>

    <p>So out of all the things I don&rsquo;t know, PowerShell is the one thing that made it to the top of my To Learn stack. Last week I ordered <a href="http://www.amazon.com/Windows-PowerShell-Action-Bruce-Payette/dp/1932394907/ref=pd_bbs_sr_1/102-7531966-1417704?ie=UTF8&amp;s=books&amp;qid=1177382702&amp;sr=8-1">PowerShell In Action</a>, it hasn&rsquo;t arrived yet but I&rsquo;ve already read about 100 pages out of the PDF (don&rsquo;t ask). The book is very well written and describes the core concepts of PowerShell very well.</p>

<p>Having (almost) never written a batch file in my life it is taking a bit for me to wrap my head around the basics but so far I love it. Compiling C# apps to do simple tasks like iterate directory structures and process files has always annoyed me. There is just too much overhead in having to compile and manage both the source code an executable when you only need the code once (until tomorrow comes).</p>

<p>I just want to create a script and run it. No compilation, no exe. Oh, and since I&rsquo;ve been completely spoiled by the .NET Framework I want access to all that too. PowerShell fits the bill.</p>

<p>My first task. Find all files with an extension of <code>*.bak</code> on my <code>C:\</code> drive and delete them.</p>

<pre><code>#  move to C: drive
cd c:\

#  list all files in C:
dir

#  list all *.BAK files in C:
dir *.BAK

#  do it recursively
dir -recurse -filter *.BAK</code></pre>

<p>Ok, so now that I&rsquo;ve got PowerShell spinning through my entire <code>C:\</code> drive, how do I stop it? You can always kill the process but I was in a pretty good mood today and decided to be nice. This is likely to be one of the most important things you learn about PowerShell so remember it well&hellip;</p>

<pre><code>CTRL+C</code></pre>

<p>That will halt execution of whatever PowerShell is doing and get you back to a prompt. Very handy for people like me who like tend to hit <code>[Enter]</code> before thinking about how long it might take to run.</p>

<blockquote>
<p><strong>TIP:</strong> <code>dir</code> (along with <code>ls</code>) is just an alias for the <code>Get-ChildItem</code> command.<br />
You can get the full syntax for this command by running <code>Get-Help dir</code>.</p>
</blockquote>

<p>And if you want to delete all those <code>*.BAK</code> files you just found? Just pipe your <code>dir</code> to <code>del</code> (which is an alias for <code>Remove-Item</code>).</p>

<pre><code>dir -recurse -filter *.BAK | del</code></pre>


</article>

<div class="fin">&#10687;</div>

</div>
</div>
	
	</section>

</div>

<nav class="pagination">



	<a href="/" aria-label="Recent Posts"><span aria-hidden="true">Recent Posts &raquo;</span></a>

</nav>

<footer>
<p>Subscribe to the <a href="/feed.xml">feed</a> to stay up-to-date.</p>
<p>Browse the <a href="/archives">archives</a> if you're bored.</p>
<p>&copy;&nbsp;2014-2015&nbsp;Joshua&nbsp;Poehls.</p>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55160531-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>