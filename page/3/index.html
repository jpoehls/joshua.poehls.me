<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<title>joshua poehls | silent thought</title>

<link rel="canonical" href="http://joshua.poehls.me/">
<link href="/feed.xml" rel="alternate" type="application/atom+xml" title="joshua poehls | silent thought">
<meta name="generator" content="Hugo 0.13" />


<link rel="stylesheet" href="/normalize.css">
<link rel="stylesheet" href="/skeleton.css">
<link rel="stylesheet" href="/styles.css">


<link href='http://fonts.googleapis.com/css?family=Merriweather' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>


<meta name="viewport" content="width=device-width, initial-scale=1">


<link rel="apple-touch-icon" href="/touch-icon-iphone.png" /> 
<link rel="apple-touch-icon" sizes="76x76" href="/touch-icon-ipad.png" /> 
<link rel="apple-touch-icon" sizes="120x120" href="/touch-icon-iphone-retina.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/touch-icon-ipad-retina.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/touch-icon-iphone-retinahd.png">

</head>
<body lang="en-US">

<header id="masthead">
	<div class="container">
		<div class="row">
			<div class="twelve columns">
				<h1>
					<small>I am</small>
					<a href="/">Joshua Poehls</a>.
					<small class="contact-link"><a href="/contact">Say hello</a></small>
					<small class="archives-link"><a href="/archives">Archives</a></small>
					<span class="aka">(not so) silent thoughts</span>
				</h1>
			</div>
		</div>
	</div>
</header>



<div class="container">

	<section id="posts">
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2007/running-vbs-scripts-under-different-credentials">Running VBS scripts under different credentials</a>
            
        </h1>
        <p>
            <time datetime="2007-09-19 00:00:00 &#43;0000 UTC" pubdate="pubdate">Wed, Sep 19, 2007</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2007/running-vbs-scripts-under-different-credentials">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2007/running-vbs-scripts-under-different-credentials</span>
            </a>
        </p>
    </header>

    <p>Today I wrote a VBS script to test out some permission settings on a server. We were debugging a problem and I needed to find out whether different user accounts had permissions to see whether a given file existed. The script was simple enough:</p>

<pre><code>Dim fso
Set fso = Server.CreateObject(&quot;FileSystemObject&quot;)
MsgBox fso.FileExists(&quot;\\superserver\path\to\file.txt&quot;)
</code></pre>

<p>Now how do I run that script as someone other than the logged in user? Go to the command line and type:</p>

<p><code>runas /profile /user:domain\username &quot;cscript.exe C:\path\to\script.vbs&quot;</code></p>

<p>When you run that it will prompt for the password of the user account you specified.</p>

<p>Note that if you leave off the <code>cscript.exe</code> part you&rsquo;ll get an error about your VBS file not being a valid Win32 application.</p>

<p>The <code>/profile</code> part may not be required depending on what your script is doing. I left it out for my simple script.</p>

<p>Visit Microsoft for <a href="http://www.microsoft.com/technet/scriptcenter/resources/qanda/apr06/hey0428.mspx">more information</a>.</p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2007/aspnet-viewstate-and-dropdownlists">ASP.NET ViewState and DropDownLists</a>
            
        </h1>
        <p>
            <time datetime="2007-05-15 00:00:00 &#43;0000 UTC" pubdate="pubdate">Tue, May 15, 2007</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2007/aspnet-viewstate-and-dropdownlists">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2007/aspnet-viewstate-and-dropdownlists</span>
            </a>
        </p>
    </header>

    

<p>Did you know ViewState is the root of all evil? Ok, maybe not all evil but certainly 90% of all ASP.NET page bloat. This isn&rsquo;t a strike against .NET, just a sign of how powerful it really is. Any platform that can enable developers to screw up so easily and never realize it has to be very powerful indeed. To borrow a quote from another blog I was reading&#0133;</p>

<blockquote>
<p>ASP.NET is so powerful that it can enable you to be an incredibly bad programmer FASTER THAN EVER.<br />
Don&rsquo;t program by coincidence.</p>
</blockquote>

<h3 id="background:f1b715c7a782221ac895a13c7c7c48d6">Background</h3>

<p>Yesterday I wanted to disable ViewState on one of my DropDownLists. Reason? The drop-down has 3000 items in it. Yes, I know, sick and wrong&hellip; It&rsquo;s bad enough that the drop-down itself is so large but with ViewState every item in the drop-down essentially gets sent to the client twice! How else do you think ViewState remembers what items were in your drop-down when you do a PostBack? It&rsquo;s very handy, but for large lists it can significantly increase the size of the page you are sending to the client.</p>

<p>Just to give you some idea, by disabling ViewState on my drop-down I saved nearly 200 kB. That&rsquo;s significant bandwidth savings, especially for those last couple of dial-up users out there.</p>

<h3 id="problem:f1b715c7a782221ac895a13c7c7c48d6">Problem</h3>

<p>Now that ViewState is disabled for my drop-down I have a few issues:</p>

<ol>
<li>ASP.NET pulls the SelectedValue property of the DropDownList out of ViewState. Guess what? No ViewState == no SelectedValue.</li>
<li>Even though <code>AutoPostBack</code> still works, the <code>SelectedIndexChanged</code> event has lost its firing pin.</li>
<li>My drop-down now loses all of its items after I any post-back occurs. Suprise, it also forgets which items was selected.</li>
</ol>

<h3 id="solution:f1b715c7a782221ac895a13c7c7c48d6">Solution</h3>

<ol>
<li><p>Despite ASP.NET&rsquo;s attempts to deceive you into thinking that everything that matters must be a Property of the control (i.e. <code>SelectedValue</code>)&hellip; ASP.NET is just a fancy wrapper around HTTP and thus any values that are set from the client are received by the server via the <code>Request.Form</code> or <code>Request.QueryString</code>.</p>

<p>Since these are POST-backs, we&rsquo;re interested in <code>Request.Form</code>. Now we just need to know that ASP.NET uses the control&rsquo;s <code>UniqueID</code> property to name the control on the client, this means that <code>Request.Form[myDropDownCtrl.UniqueID]</code> will give me the value of that drop-down list as it was sent from the client. This is the exact same as <code>myDropDownCtrl.SelectedValue</code>. Bingo!</p></li>

<li><p>There are ways to get the <code>SelectedIndexChanged</code> event to fire again but I found an easier work-around for my needs. This also covers #3.</p></li>
</ol>

<pre><code>protected string MySelectedValue
{
 get
 {
   return (ViewState[&quot;MySelectedValue&quot;] == null) ? null : ViewState[&quot;MySelectedValue&quot;].ToString();
 }
 set
 {
   ViewState[&quot;MySelectedValue&quot;] = value;
 }
}

protected void Page_Load(object sender, EventArgs e)
{
 // Check if the selectedValue has changed.
 string selectedValue = Request[myDropDownCtrl.UniqueID];
 if (selectedValue != MySelectedValue)
 {
   // Value has changed, do whatever you would do in the SelectedIndexChanged event here.
 }
 MySelectedValue = selectedValue;

 // TODO: Populate the drop-down control
 PopulateMyDropDownCtrl();

 // set the set the selectedValue on the drop-down
 if (selectedValue != null)
 {
   myDropDownCtrl.Items.FindByValue(selectedValue).Selected = true;
 }
}
</code></pre>

<p><em>I didn&rsquo;t actually test this exact code, so&#0133; this code comes as-is, untested and without any guarantees. Let me know if there is a bug and I&rsquo;ll correct it.</em></p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2007/clearing-aspnet-control-values">Clearing ASP.NET control values</a>
            
        </h1>
        <p>
            <time datetime="2007-04-25 00:00:00 &#43;0000 UTC" pubdate="pubdate">Wed, Apr 25, 2007</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2007/clearing-aspnet-control-values">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2007/clearing-aspnet-control-values</span>
            </a>
        </p>
    </header>

    <p>Have you ever needed to clear the values of a bunch of TextBoxes on your ASP.NET page? Not all the TextBoxes, but maybe all the ones in a certain Panel. Or maybe you need to reset all the DropDownLists too?</p>

<p>This is a method I wrote to do just that. It clears the values of all child controls under a given parent. Enjoy.</p>

<pre><code>public static void ClearControlValues(Control parentCtrl, bool recursive)
{
 ClearControlValues(parentCtrl, recursive, new List&amp;lt;Control&amp;gt;(0));
}

public static void ClearControlValues(Control parentCtrl, bool recursive, List&amp;lt;Control&amp;gt; ignoreControls)
{
 foreach (Control ctrl in parentCtrl.Controls)
 {
     bool skipMe = false;

     foreach (Control ignoreCtrl in ignoreControls)
     {
         if (ctrl.ID == ignoreCtrl.ID)
         {
             skipMe = true;
             break;
         }
     }

     if (skipMe)
         continue;

     if (ctrl.GetType() == typeof(TextBox))
         ((TextBox)ctrl).Text = string.Empty;

     if (ctrl.GetType() == typeof(DropDownList))
         ((DropDownList)ctrl).ClearSelection();

     if (ctrl.GetType() == typeof(RadioButton))
         ((RadioButton)ctrl).Checked = false;

     if (ctrl.GetType() == typeof(CheckBox))
         ((CheckBox)ctrl).Checked = false;

     if (ctrl.GetType() == typeof(RadioButtonList))
         ((RadioButtonList)ctrl).ClearSelection();

     if (ctrl.GetType() == typeof(CheckBoxList))
         ((CheckBoxList)ctrl).ClearSelection();

     if (ctrl.GetType() == typeof(ListBox))
         ((ListBox)ctrl).ClearSelection();


     if (recursive == true)
     {
         ClearControlValues(ctrl, true, ignoreControls);
     }
 }
}
</code></pre>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2007/recursively-deleting-files-with-powershell">Recursively deleting files with PowerShell</a>
            
        </h1>
        <p>
            <time datetime="2007-04-23 10:43:31 -0600 -0600" pubdate="pubdate">Mon, Apr 23, 2007</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2007/recursively-deleting-files-with-powershell">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2007/recursively-deleting-files-with-powershell</span>
            </a>
        </p>
    </header>

    <p>So out of all the things I don&rsquo;t know, PowerShell is the one thing that made it to the top of my To Learn stack. Last week I ordered <a href="http://www.amazon.com/Windows-PowerShell-Action-Bruce-Payette/dp/1932394907/ref=pd_bbs_sr_1/102-7531966-1417704?ie=UTF8&amp;s=books&amp;qid=1177382702&amp;sr=8-1">PowerShell In Action</a>, it hasn&rsquo;t arrived yet but I&rsquo;ve already read about 100 pages out of the PDF (don&rsquo;t ask). The book is very well written and describes the core concepts of PowerShell very well.</p>

<p>Having (almost) never written a batch file in my life it is taking a bit for me to wrap my head around the basics but so far I love it. Compiling C# apps to do simple tasks like iterate directory structures and process files has always annoyed me. There is just too much overhead in having to compile and manage both the source code an executable when you only need the code once (until tomorrow comes).</p>

<p>I just want to create a script and run it. No compilation, no exe. Oh, and since I&rsquo;ve been completely spoiled by the .NET Framework I want access to all that too. PowerShell fits the bill.</p>

<p>My first task. Find all files with an extension of <code>*.bak</code> on my <code>C:\</code> drive and delete them.</p>

<pre><code>#  move to C: drive
cd c:\

#  list all files in C:
dir

#  list all *.BAK files in C:
dir *.BAK

#  do it recursively
dir -recurse -filter *.BAK
</code></pre>

<p>Ok, so now that I&rsquo;ve got PowerShell spinning through my entire <code>C:\</code> drive, how do I stop it? You can always kill the process but I was in a pretty good mood today and decided to be nice. This is likely to be one of the most important things you learn about PowerShell so remember it well&hellip;</p>

<p><code>CTRL+C</code></p>

<p>That will halt execution of whatever PowerShell is doing and get you back to a prompt. Very handy for people like me who like tend to hit <code>[Enter]</code> before thinking about how long it might take to run.</p>

<blockquote>
<p><strong>TIP:</strong> <code>dir</code> (along with <code>ls</code>) is just an alias for the <code>Get-ChildItem</code> command.<br />
You can get the full syntax for this command by running <code>Get-Help dir</code>.</p>
</blockquote>

<p>And if you want to delete all those <code>*.BAK</code> files you just found? Just pipe your <code>dir</code> to <code>del</code> (which is an alias for <code>Remove-Item</code>).</p>

<p><code>dir -recurse -filter *.BAK | del</code></p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	</section>

</div>

<nav class="pagination">



	<a href="/page/2/" aria-label="Recent Posts"><span aria-hidden="true">Recent Posts &raquo;</span></a>

</nav>

<footer>
<p>Subscribe to the <a href="/feed.xml">feed</a> to stay up-to-date.</p>
<p>Browse the <a href="/archives">archives</a> if you're bored.</p>
<p>&copy;&nbsp;2014-2015&nbsp;Joshua&nbsp;Poehls.</p>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55160531-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>