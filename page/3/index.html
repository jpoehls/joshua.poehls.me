<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<title>joshua poehls | silent thought</title>

<link rel="canonical" href="http://joshua.poehls.me/">
<link href="/feed.xml" rel="alternate" type="application/atom+xml" title="joshua poehls | silent thought">
<meta name="generator" content="Hugo 0.14" />


<link rel="stylesheet" href="/normalize.css">
<link rel="stylesheet" href="/skeleton.css">
<link rel="stylesheet" href="/styles.css">


<link href='http://fonts.googleapis.com/css?family=Merriweather' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>


<meta name="viewport" content="width=device-width, initial-scale=1">


<link rel="apple-touch-icon" href="/touch-icon-iphone.png" /> 
<link rel="apple-touch-icon" sizes="76x76" href="/touch-icon-ipad.png" /> 
<link rel="apple-touch-icon" sizes="120x120" href="/touch-icon-iphone-retina.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/touch-icon-ipad-retina.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/touch-icon-iphone-retinahd.png">

</head>
<body lang="en-US">

<header id="masthead">
	<div class="container">
		<div class="row">
			<div class="twelve columns">
				<h1>
					<small>I am</small>
					<a href="/">Joshua Poehls</a>.
					<small class="contact-link"><a href="/contact">Say hello</a></small>
					<small class="archives-link"><a href="/archives">Archives</a></small>
					<span class="aka">(not so) silent thoughts</span>
				</h1>
			</div>
		</div>
	</div>
</header>



<div class="container">

	<section id="posts">
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2012/powershell-script-module-boilerplate">PowerShell, batch files, and exit codes. Recipes &amp; Secrets.</a>
            
        </h1>
        <p>
            <time datetime="2012-06-23 10:43:31 -0600 -0600" pubdate="pubdate">Sat, Jun 23, 2012</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2012/powershell-script-module-boilerplate">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2012/powershell-script-module-boilerplate</span>
            </a>
        </p>
    </header>

    

<h2 id="tl-dr:e436619b3c225495df020f575a03107f">TL;DR;</h2>

<blockquote>
<p><strong>Update:</strong> If you want to save some time, skip reading this and just use my <a href="/powershell-script-boilerplate">PowerShell Script Boilerplate</a>. It includes an excellent batch file wrapper, argument escaping, and error code bubbling.</p>
</blockquote>

<p><code>PowerShell.exe</code> doesn&rsquo;t return correct exit codes when using the <code>-File</code> option. Use <code>-Command</code> instead. <em>(<a href="https://connect.microsoft.com/PowerShell/feedback/details/750653/powershell-exe-doesn-t-return-correct-exit-codes-when-using-the-file-option">Vote for this issue</a> on Microsoft Connect.)</em></p>

<p><a href="#bat-wrapper">This</a> is a batch file wrapper for executing PowerShell scripts. It forwards arguments to PowerShell and correctly bubbles up the exit code (when it can).</p>

<p><code>PowerShell.exe</code> still <a href="#command-parsererror">returns a passing (0) exit code when a <code>ParserError</code> is thrown</a>. Even when using <code>-Command</code>. I haven&rsquo;t found a workaround for this. <em>(<a href="https://connect.microsoft.com/PowerShell/feedback/details/750654/powershell-exe-returns-a-passing-0-exit-code-when-a-parsererror-is-thrown">Vote for this issue</a> on Microsoft Connect.)</em></p>

<p>You can use <a href="#black-magic">black magic</a> to include spaces and quotes in the arguments you pass through the batch file wrapper to PowerShell.</p>

<h2 id="powershell:e436619b3c225495df020f575a03107f">PowerShell</h2>

<p>PowerShell is a great scripting environment, and it is my preferred tool for writing build scripts for .NET apps. Exit codes are vital in build scripts because they are how your Continuous Integration server knows whether the build passed or failed.</p>

<p>This is a <strike>quick</strike> tour of working with exit codes in PowerShell scripts and batch files. I&rsquo;m including batch files because they are often necessary to wrap the execution of your PowerShell scripts.</p>

<p>Let&rsquo;s start easy. Say you need to run a command line app or batch file from your PowerShell script. How can you check the exit code of that process?</p>

<pre><code># script.ps1

cmd /C exit 1
Write-Host $LastExitCode    # 1
</code></pre>

<p><code>$LastExitCode</code> is a special variable that holds the exit code of the last Windows based program that was run. So says <a href="http://technet.microsoft.com/en-us/library/dd347675.aspx">the documentation</a>.</p>

<p>Remember though, <code>$LastExitCode</code> doesn&rsquo;t do squat for PowerShell commands. Use <code>$?</code> for that.</p>

<pre><code># script.ps1

Get-ChildItem &quot;C:\&quot;
Write-Host $?    # True

Get-ChildItem &quot;Z:\some\non-existant\path&quot;
Write-Host $?    # False
</code></pre>

<p>Anytime you run an external command like this, you need to check the exit code and throw an exception if needed. Otherwise the PowerShell script will keep right on trucking after a failure.</p>

<pre><code># script.ps1

cmd /C exit 1
if ($LastExitCode -ne 0) {
    throw &quot;Command failed with exit code $LastExitCode.&quot;
}
Write-Host &quot;You'll never see this.&quot;
</code></pre>

<p>Writing these assertions all the time will get old. Fortunately you can use a helper function, like this one found in the <a href="http://github.com/psake/psake">excellent psake project</a>.</p>

<pre><code># script.ps1

function Exec
{
    [CmdletBinding()]
    param (
        [Parameter(Position=0, Mandatory=1)]
        [scriptblock]$Command,
        [Parameter(Position=1, Mandatory=0)]
        [string]$ErrorMessage = &quot;Execution of command failed.`n$Command&quot;
    )
    &amp; $Command
    if ($LastExitCode -ne 0) {
        throw &quot;Exec: $ErrorMessage&quot;
    }
}

Exec { cmd /C exit 1 }
Write-Host &quot;You'll never see this.&quot;
</code></pre>

<h3 id="throwing-exit-codes:e436619b3c225495df020f575a03107f">Throwing &amp; exit codes</h3>

<p>The <code>throw</code> keyword is how you generate a terminating error in PowerShell. It will, sometimes, cause your PowerShell script to return a failing exit code (1). Wait, when does it <em>not</em> cause a failing exit code, you ask? This is where PowerShell&rsquo;s warts start to show. Let me demonstrate some scenarios.</p>

<pre><code># broken.ps1

throw &quot;I'm broken&quot;
</code></pre>

<p><em>From the PowerShell command prompt:</em></p>

<pre><code>PS&gt; .\broken.ps1
<span style="color: red;">I'm broken.
At C:\broken.ps1:1 char:6
+ throw &lt;&lt;&lt;&lt;  "I'm broken."
    + CategoryInfo          : OperationStopped: (I'm broken.:String) [], RuntimeException
    + FullyQualifiedErrorId : I'm broken.</span>
    
PS&gt; $LastExitCode
1</code></pre>

<p><em>From the Windows command prompt:</em></p>

<pre><code>&gt; PowerShell.exe -NoProfile -NonInteractive -ExecutionPolicy unrestricted -Command ".\broken.ps1"
<span style="color: red;">I'm broken.
At C:\broken.ps1:1 char:6
+ throw &lt;&lt;&lt;&lt;  "I'm broken."
    + CategoryInfo          : OperationStopped: (I'm broken.:String) [], RuntimeException
    + FullyQualifiedErrorId : I'm broken.</span>
    
&gt; echo %errorlevel%
1</code></pre>

<p>That worked, too. Good.</p>

<p><em>Again, from the Windows command prompt:</em></p>

<pre><code>&gt; PowerShell.exe -NoProfile -NonInteractive -ExecutionPolicy unrestricted <b>-File</b> ".\broken.ps1"
<span style="color: red;">I'm broken.
At C:\broken.ps1:1 char:6
+ throw &lt;&lt;&lt;&lt;  "I'm broken."
    + CategoryInfo          : OperationStopped: (I'm broken.:String) [], RuntimeException
    + FullyQualifiedErrorId : I'm broken.</span>

&gt; echo %errorlevel%
0</code></pre>

<p>Whoa! We still saw the error, but PowerShell returned a passing exit code. What the heck?! Yes, this is the wart.</p>

<h3 id="a-workaround-for-file:e436619b3c225495df020f575a03107f">A workaround for <code>-File</code></h3>

<p><code>-File</code> allows you to pass in a script for PowerShell to execute, however terminating errors in the script will not cause PowerShell to return a failing exit code. I have no idea why this is the case. If you know why, please share!</p>

<p>A workaround is to add a <code>trap</code> statement to the top of your PowerShell script. (Thanks, Chris Oldwood, for <a href="http://chrisoldwood.blogspot.com/2011/05/powershell-throwing-exceptions-exit.html">pointing this out</a>!)</p>

<pre><code># broken.ps1

trap
{
    Write-Error $_
    exit 1
}
throw &quot;I'm broken.&quot;
</code></pre>

<p><em>From the Windows command prompt:</em></p>

<pre><code>&gt; PowerShell.exe -NoProfile -NonInteractive -ExecutionPolicy unrestricted <b>-File</b> ".\script.ps1"
<span style="color: red;">C:\broken.ps1 : I'm broken.
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,broken.ps1</span>

&gt; echo %errorlevel%
1</code></pre>  

<p>Notice that we got the correct exit code this time, but our error output didn&rsquo;t include as much detail. Specifically, we didn&rsquo;t get the line number of the error like we were getting in the previous tests. So it isn&rsquo;t a perfect workaround.</p>

<p><strong>Remember.</strong> Use <code>-Command</code> instead of <code>-File</code> whenever possible. If for some reason you must use <code>-File</code> or your script needs to support being run that way, then use the trap workaround above.</p>

<p><a id="command-parsererror"> </a></p>

<h3 id="command-can-still-fail:e436619b3c225495df020f575a03107f"><code>-Command</code> can still fail</h3>

<p>I&rsquo;ve discovered that PowerShell will still exit with a success code (0) when a <code>ParserError</code> is thrown. Even when using <code>-Command</code>.</p>

<p><em>From the Windows command prompt:</em></p>

<pre><code>&gt; PowerShell.exe -NoProfile -NonInteractive -Command "Write-Host 'You will never see this.'" <b>"\"</b>
<span style="color: red;">The string starting:
At line:1 char:39
+ Write-Host 'You will never see this.'  &lt;&lt;&lt;&lt; "
is missing the terminator: ".
At line:1 char:40
+ Write-Host 'You will never see this.' " &lt;&lt;&lt;&lt;
    + CategoryInfo          : <b>ParserError</b>: (:String) [], ParentContainsErrorRecordException
    + FullyQualifiedErrorId : TerminatorExpectedAtEndOfString</span>

&gt; echo %errorlevel%
0</code></pre>

<p>I&rsquo;m not aware of any workaround for this behavior. This is very disturbing, because these parser errors can be caused by arguments (as I demonstrated above). This means there is no way to guarantee your script will exit with the correct code when it fails.</p>

<p><em>Note: This was tested in PowerShell v2, on Windows 7 (x64).</em></p>

<p>There are <a href="https://connect.microsoft.com/PowerShell/feedback/details/637113/powershell-command-line-exit-codes-inconsistency">other</a> <a href="https://connect.microsoft.com/PowerShell/feedback/details/638771/powershell-return-code-and-parameters">known</a> bugs with PowerShell&rsquo;s exit codes. Beware.</p>

<h2 id="batch-files:e436619b3c225495df020f575a03107f">Batch files</h2>

<p>I mentioned early on that it is often necessary to wrap the execution of your PowerShell script in a batch file. Some common reasons for this might be:</p>

<ul>
<li>You want users of your script to be able to double-click to run it.</li>
<li>Your build runner doesn&rsquo;t support execution of PowerShell scripts directly.</li>
</ul>

<p>Whatever the reason, writing a batch file wrapper for a PowerShell script is easy. You just need to make sure that your batch file properly returns the exit code from PowerShell. Otherwise, your PowerShell script might fail and your batch file would return a successful exit code (0).</p>

<p><a id="bat-wrapper"> </a></p>

<p><del>This is a safe template for you to use. Bookmark it.</del></p>

<blockquote>
<p><strong>Update:</strong> I&rsquo;ve created a <em>much</em> better batch file wrapper for my PowerShell scripts. I recommend you ignore the one below and <strong><a href="/powershell-batch-file-wrapper">use my new one</a></strong> instead.</p>
</blockquote>

<pre><code>:: script.bat

@ECHO OFF
PowerShell.exe -NoProfile -NonInteractive -ExecutionPolicy unrestricted -Command &quot;&amp; %~d0%~p0%~n0.ps1&quot; %*
EXIT /B %errorlevel%
</code></pre>

<p>This wrapper will execute the PowerShell script with the same file name (i.e., <code>script.ps1</code> if the batch file is named <code>script.bat</code>), and then exit with the same code that PowerShell exited with. It will also forward any arguments passed to the batch file, to the PowerShell script.</p>

<p>Let&rsquo;s test it out.</p>

<pre><code># script.ps1

param($Arg1, $Arg2)
Write-Host &quot;Arg 1: $Arg1&quot;
Write-Host &quot;Arg 2: $Arg2&quot;
</code></pre>

<p><em>From the Windows command prompt:</em></p>

<pre><code>&gt; script.bat happy scripting
Arg 1: happy
Arg 2: scripting
</code></pre>

<p>What if we want &ldquo;happy scripting&rdquo; to be passed as a single argument?</p>

<pre><code>&gt; script.bat &quot;happy scripting&quot;
Arg 1: happy
Arg 2: scripting
</code></pre>

<p><a id="black-magic"> </a></p>

<p>Well that didn&rsquo;t work at all. This is the secret recipe.</p>

<pre><code>&gt; script.bat &quot;'Happy scripting with single '' and double \&quot; quotes!'&quot;
Arg 1: Happy scripting with single ' and double &quot; quotes!
Arg 2:
</code></pre>

<p>Please don&rsquo;t ask me to explain this black magic, I only know that it works. Much credit to <a href="http://stackoverflow.com/questions/6714165/powershell-stripping-double-quotes-from-command-line-arguments">this StackOverflow question</a> for helping me solve this!</p>

<p>For comparison, here is how you would do it if you were executing the script from PowerShell, without using the batch file wrapper.</p>

<p><em>From the PowerShell command prompt:</em></p>

<pre><code>PS&gt; .\script.ps1 happy scripting
Arg 1: happy
Arg 2: scripting

PS&gt; .\script.ps1 &quot;Happy scripting with single ' and double `&quot; quotes included!&quot;
Arg 1: Happy scripting with single ' and double &quot; quotes included!
Arg 2:
</code></pre>

<p>That&rsquo;s all folks!</p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2012/syntax-highlighting-for-nginx-in-vim">Syntax highlighting for Nginx in VIM</a>
            
        </h1>
        <p>
            <time datetime="2012-06-10 00:00:00 &#43;0000 UTC" pubdate="pubdate">Sun, Jun 10, 2012</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2012/syntax-highlighting-for-nginx-in-vim">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2012/syntax-highlighting-for-nginx-in-vim</span>
            </a>
        </p>
    </header>

    <p>Thanks to <a href="http://www.vim.org/scripts/script.php?script_id=1886">Evan Miller</a>, adding VIM syntax highlighting for Nginx config files is a breeze.</p>

<p>First, install VIM if you haven&rsquo;t already. On Arch Linux, it goes like this:</p>

<pre><code>&gt; pacman -Sy vim
</code></pre>

<p>Create a folder for your VIM syntax files.</p>

<pre><code>&gt; mkdir -p ~/.vim/syntax/
</code></pre>

<p>Download the syntax highlighting plugin.</p>

<pre><code>&gt; curl http://www.vim.org/scripts/download_script.php?src_id=14376 -o ~/.vim/syntax/nginx.vim
</code></pre>

<p>Add it to VIM&rsquo;s file type definitions. Make sure to adjust the path to your Nginx installation if you need to.</p>

<pre><code>&gt; echo &quot;au BufRead,BufNewFile /etc/nginx/conf/* set ft=nginx&quot; &gt;&gt; ~/.vim/filetype.vim
</code></pre>

<p>Now enable syntax highlighting in your .vimrc file.</p>

<pre><code>&gt; echo &quot;syntax enable&quot; &gt;&gt; ~/.vimrc
</code></pre>

<p>That&rsquo;s it. Now you&rsquo;ll have nice colors when you edit your Nginx configs with VIM!</p>

<pre><code>&gt; vim /etc/nginx/conf/nginx.conf
</code></pre>

<p><figure >

<img src="/2012/06/nginx-vim-colors.png" alt="Screenshot of VIM with syntax highlighting in an Nginx config file" />


<figcaption>
<p>
Screenshot of VIM with syntax highlighting in an Nginx config file



</p> 
</figcaption>

</figure></p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2012/storing-your-raspberry-pi-configuration-in-git">Storing your Raspberry Pi configuration in Git</a>
            
        </h1>
        <p>
            <time datetime="2012-06-08 00:00:00 &#43;0000 UTC" pubdate="pubdate">Fri, Jun 8, 2012</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2012/storing-your-raspberry-pi-configuration-in-git">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2012/storing-your-raspberry-pi-configuration-in-git</span>
            </a>
        </p>
    </header>

    <p>Storing your Raspberry Pi&rsquo;s configuration files in Git is a great way to protect yourself from really bad accidents. You get a backup of all your configs and revision control to rollback those nasty changes. Best of all, you don&rsquo;t have to manually create backup copies of each individual file. (<code>cp rc.conf rc.conf.bak</code> anyone?)</p>

<p>I should note that I&rsquo;m running <a href="http://archlinuxarm.org">Arch Linux ARM</a>, but this should apply fairly equally to Debian and other distros.</p>

<p>First, install <a href="http://git-scm.com">Git</a> (if you haven&rsquo;t already).</p>

<pre><code>&gt; pacman -Sy git
</code></pre>

<p>Arch has a convention of storing all configuration files in <code>/etc</code>. So we will initialize our Git repo there.</p>

<pre><code>&gt; cd /etc
&gt; git init
</code></pre>

<p>We only want to store the configuration files that we&rsquo;ve actually changed in Git. We&rsquo;ll use a <code>.gitignore</code> file for that.</p>

<pre><code>&gt; vim .gitignore
</code></pre>

<p>Here is what mine looks like right now.</p>

<pre><code># Blacklist everything.
*

# Whitelist the files we care about.
!rc.conf
!rc.local
!ntp.conf
!resolv.conf

!ddclient/
!ddclient/ddclient.conf

!nginx/
!nginx/conf/
!nginx/conf/nginx.conf
</code></pre>

<p>The <strong>!</strong> prefix negates the pattern, basically creating a whitelist. Cool, huh?</p>

<p>Now we can do our initial commit.</p>

<pre><code>&gt; git add -A
&gt; git commit -m &quot;Added initial configs.&quot;
</code></pre>

<p>Remember to add any new config files to your <code>.gitignore</code> file and always commit your changes!</p>

<p>For added security you should push your repository to <a href="http://git-scm.com/book/en/Git-Basics-Working-with-Remotes">a remote</a>. <a href="http://bitbucket.org">BitBucket</a> offers free private repositories, if you don&rsquo;t have a paid <a href="http://github.com">Github</a> account.</p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2012/soft-links-hard-links-junctions-oh-my-symlinks-on-windows-a-how-to">Soft links, hard links, junctions, oh my! Symlinks on Windows, a how-to</a>
            
        </h1>
        <p>
            <time datetime="2012-06-07 00:00:00 &#43;0000 UTC" pubdate="pubdate">Thu, Jun 7, 2012</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2012/soft-links-hard-links-junctions-oh-my-symlinks-on-windows-a-how-to">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2012/soft-links-hard-links-junctions-oh-my-symlinks-on-windows-a-how-to</span>
            </a>
        </p>
    </header>

    

<p>First, a quick definition of terms. There are three kinds of &ldquo;<a href="https://en.wikipedia.org/wiki/Symbolic_link">symlinks</a>&rdquo; on Windows.</p>

<ul>
<li>soft links (also called symlinks, or symbolic links)</li>
<li>hard links</li>
<li>junctions (a type of soft link only for directories)</li>
</ul>

<p>Soft links can be created for files or directories.</p>

<p>Hard links can only be created for files.</p>

<p>Both soft and hard links must be created on the same volume as the target. i.e. You can&rsquo;t link something on <code>C:\</code> to something on <code>D:\</code>.</p>

<p>You can read more about hardlinks and junctions <a href="http://msdn.microsoft.com/en-us/library/aa365006%28VS.85%29.aspx">on MSDN</a>.</p>

<h3 id="deleting-links:9e58f074bd866214c10dc323b4e5109d">Deleting Links</h3>

<p>This is where the difference between soft and hard links is most evident.</p>

<p>Deleting the target will cause soft links to stop working. What it points to is gone. Hard links however will keep right on working until you delete the hard link itself. The hard link acts just like the original file, because for all intents and purposes, it is the original file.</p>

<h3 id="junctions:9e58f074bd866214c10dc323b4e5109d">Junctions</h3>

<p>Windows also has another type of link just for directories, called Junctions.</p>

<p>Junctions look and act like soft links. The key difference is that they allow you to link directories that are located on different local volumes (but still on the same computer). You can&rsquo;t create a junction to a network location.</p>

<h2 id="using-mklink:9e58f074bd866214c10dc323b4e5109d">Using MKLINK</h2>

<p>Create a soft link to a directory.</p>

<pre><code>c:\symlink_test&gt; mklink symlink_dir real_dir
symbolic link created for symlink_dir &lt;&lt;===&gt;&gt; real_dir
</code></pre>

<p>Create junction link to a directory.</p>

<pre><code>c:\symlink_test&gt; mklink /J junction_dir real_dir
Junction created for junction_dir &lt;&lt;===&gt;&gt; real_dir
</code></pre>

<p>Create a soft link to a file.</p>

<pre><code>c:\symlink_test&gt; mklink symlink_file.txt real_file.txt
symbolic link created for symlink_file.txt &lt;&lt;===&gt;&gt; real_file.txt
</code></pre>

<p>Create a hard link to a file.</p>

<pre><code>c:\symlink_test&gt; mklink /H hardlink_file.txt real_file.txt
Hardlink created for hardlink_file.txt &lt;&lt;===&gt;&gt; real_file.txt
</code></pre>

<p>What they look like.</p>

<pre><code>c:\symlink_test&gt; dir
Volume in drive C is OS
Volume Serial Number is 7688-08EC

Directory of c:\symlink_test

06/07/2012  10:32 AM    &lt;DIR&gt;          .
06/07/2012  10:32 AM    &lt;DIR&gt;          ..
06/07/2012  09:51 AM                15 hardlink_file.txt
06/07/2012  09:59 AM    &lt;JUNCTION&gt;     junction_dir [c:\symlink_test\real_dir]
06/07/2012  09:47 AM    &lt;DIR&gt;          real_dir
06/07/2012  09:51 AM                15 real_file.txt
06/07/2012  10:00 AM    &lt;SYMLINKD&gt;     symlink_dir [real_dir]
06/07/2012  10:31 AM    &lt;SYMLINK&gt;      symlink_file.txt [real_file.txt]
               3 File(s)             30 bytes
               5 Dir(s)  145,497,268,224 bytes free
</code></pre>

<p><figure >

<img src="/2012/06/mklink/explorer-screenshot.png" alt="Screenshot of folder in Windows Explorer" />


<figcaption>
<p>
Screenshot of folder in Windows Explorer



</p> 
</figcaption>

</figure></p>

<p><strong>Note for PowerShell users:</strong><br />
MKLINK isn&rsquo;t an executable that you can just call from PowerShell. You have to call it through the command prompt.</p>

<pre><code>cmd /c mklink /D symlink_dir real_dir
</code></pre>

<p>Alternatively, you can use <a href="https://gist.github.com/2891103">this module</a> I wrote that has native PowerShell wrappers for MKLINK.</p>

<p><a href="http://technet.microsoft.com/en-us/library/cc753194(v=WS.10).aspx">Read about MKLINK on MSDN.</a></p>

<h2 id="using-fsutil:9e58f074bd866214c10dc323b4e5109d">Using FSUTIL</h2>

<p>FSUTIL is another way to create hard links (but not soft links). This is the same as <code>mklink /H</code>.</p>

<pre><code>c:\symlink_test&gt; where fsutil
c:\Windows\System32\fsutil.exe

c:\symlink_test&gt; fsutil hardlink create hardlink_file.txt real_file.txt
Hardlink created for c:\symlink_test\hardlink_file.txt &lt;&lt;===&gt;&gt; c:\symlink_test\real_file.txt
</code></pre>

<p><a href="http://technet.microsoft.com/en-us/library/cc753059(v=WS.10).aspx">Read about FSUTIL on MSDN.</a></p>

<h2 id="using-junction:9e58f074bd866214c10dc323b4e5109d">Using Junction</h2>

<p>Junction is a tool provided by Sysinternals and provides another way to create junctions. Same as <code>mklink /J</code>.
It also has some other tools for working with junctions that I won&rsquo;t cover here.</p>

<pre><code>c:\symlink_test&gt; junction junction_dir real_dir
Junction v1.06 - Windows junction creator and reparse point viewer
Copyright (C) 2000-2010 Mark Russinovich
Sysinternals - www.sysinternals.com

Created: c:\symlink_test\junction_dir
Targetted at: c:\symlink_test\real_dir
</code></pre>

<p><a href="http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx">Download the Junction tool from Sysinternals.</a></p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2012/cant-access-network-resources-over-vpn-connection-on-mac-os-x">Can&#39;t access network resources over VPN connection on Mac OS X?</a>
            
        </h1>
        <p>
            <time datetime="2012-04-18 00:00:00 &#43;0000 UTC" pubdate="pubdate">Wed, Apr 18, 2012</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2012/cant-access-network-resources-over-vpn-connection-on-mac-os-x">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2012/cant-access-network-resources-over-vpn-connection-on-mac-os-x</span>
            </a>
        </p>
    </header>

    <p>So you have your shiny OS X connected to a VPN, good deal! The problem is, you can&rsquo;t connect to any of the servers and workstations on the VPN. What could be wrong?</p>

<p>It could be that OS X is still trying to find those machines on the internet instead of looking for them on the VPN connection. We can tell OS X to check the VPN connection first by giving it a higher priority than the other network connections on your Mac.</p>

<p>To change the priority of your VPN connection:</p>

<ol>
<li>Choose Apple menu &gt; System Preferences and click Network.</li>
<li>Choose Set Service Order from the Action pop-up menu (looks like a gear).</li>
<li>Drag your VPN connection to the top of the list.</li>
<li>Click OK, and then click Apply to make the new settings active.</li>
</ol>

<p>This solution saved my day when I couldn&rsquo;t Remote Desktop into my workstation over the VPN.</p>

<p>For more information, refer to <a href="http://docs.info.apple.com/article.html?path=Mac/10.6/en/8853.html">Apple&rsquo;s documentation for this</a>.</p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2011/use-autohotkey-to-remap-your-numpad-keys-to-something-useful">Use AutoHotkey to remap your numpad keys to something useful</a>
            
        </h1>
        <p>
            <time datetime="2011-12-14 00:00:00 &#43;0000 UTC" pubdate="pubdate">Wed, Dec 14, 2011</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2011/use-autohotkey-to-remap-your-numpad-keys-to-something-useful">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2011/use-autohotkey-to-remap-your-numpad-keys-to-something-useful</span>
            </a>
        </p>
    </header>

    

<p>Are you tired of having to remember that <code>ALT+0176</code> is the degree symbol <strong>&deg;</strong> ? Maybe there are other special characters that you want to be able to type easier.</p>

<p>Personally it was the degree symbol that got me, and since I never use my numpad, I decided it would be much more useful if those keys actually entered stuff that I cared about.</p>

<p>Here is a quick tutorial in using AutoHotkey to remap one of your numpad keys to the degree symbol. Of course you can expand on this beginning easily to solve whatever woes you are having.</p>

<p>Start out by going to <a href="http://www.autohotkey.com">the AutoHotkey website</a>.</p>

<p>Download the <strong>AutoHotkey_L</strong> installer. This is the most recent version of AutoHotkey and specifically supports Unicode which is important for us.</p>

<p><figure >

<img src="/2011/12/autohotkey/Image4.png" alt="Screenshot of the AutoHotkey download page" />


<figcaption>
<p>
Screenshot of the AutoHotkey download page



</p> 
</figcaption>

</figure></p>

<p>Run the installer and leave all the defaults.</p>

<p><figure >

<img src="/2011/12/autohotkey/Image3.png" alt="Screenshot of the AutoHotkey installer" />


<figcaption>
<p>
Screenshot of the AutoHotkey installer



</p> 
</figcaption>

</figure></p>

<p>Look in your My Documents folder and open up <code>AutoHotkey.ahk</code> in a text editor that you can save as UTF-8 in.</p>

<p>If you don&rsquo;t know what this means or don&rsquo;t have an editor that can do this then <a href="http://www.flos-freeware.ch/notepad2.html">download Notepad2</a> and open the file in that program.</p>

<p><figure >

<img src="/2011/12/autohotkey/Image5.png" alt="Screenshot of the AutoHotkey.ahk file in Windows Explorer" />


<figcaption>
<p>
Screenshot of the AutoHotkey.ahk file in Windows Explorer



</p> 
</figcaption>

</figure></p>

<p>Now that you have <code>AutoHotkey.ahk</code> opened, delete everything in there (after reading it if you care) and paste the following in its place.</p>

<pre><code>NumpadIns::
Send &deg;
return</code></pre>

<p>Now save this file with <strong>UTF-8</strong> encoding. If you are using Notepad2 you can do this by going to <code>File | Encoding | UTF-8</code> and clicking <strong>Yes</strong> to the warning. Then click <code>File | Save</code> as usual.</p>

<p><figure >

<img src="/2011/12/autohotkey/Image.png" alt="Screenshot of saving the file with UTF-8 encoding" />


<figcaption>
<p>
Screenshot of saving the file with UTF-8 encoding



</p> 
</figcaption>

</figure></p>

<p>Finally, run the <strong>AutoHotkey</strong> program from your Start Menu.</p>

<p><figure >

<img src="/2011/12/autohotkey/Image2.png" alt="Screenshot of AutoHotkey in the Start Menu" />


<figcaption>
<p>
Screenshot of AutoHotkey in the Start Menu



</p> 
</figcaption>

</figure></p>

<h3 id="now-to-try-it-out:92951ddff719c4a186337f8b68cc78b3">Now to try it out!</h3>

<p>Put your focus in any text box. Anywhere. Go ahead. Now make sure you have NumLock turned OFF and hit the <code>0</code> key on your numpad.</p>

<p>See what just happened? No, that&rsquo;s not a superscripted zero. That&rsquo;s a degree symbol. Now that they are easy to type you are going to have to learn what it is! ;)</p>

<p>You can get a list of other special key names here: <a href="http://www.autohotkey.com/docs/KeyList.htm">http://www.autohotkey.com/docs/KeyList.htm</a></p>

<p>This is just scratching the surface of what you can do with AutoHotkey scripts. Be sure to <a href="http://l.autohotkey.net/docs/">read up on the documentation</a> for more ideas. Knowledge is power!</p>

<p>Here is a teaser of just a few of the tricks you can do:</p>

<ul>
<li>Create global shortcuts to run programs (ex. <code>CTRL+Z</code> to open a browser and navigate to a specific website.)</li>
<li>Replace acronyms or common spelling mistakes (ex. replace &ldquo;restraunt&rdquo; -&gt; &ldquo;restaurant&rdquo; automatically.)</li>
<li>Toggle hidden files in Windows Explorer with a shortcut key.</li>
</ul>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2011/what-i-miss-in-vanilla-visual-studio">What I miss in vanilla Visual Studio</a>
            
        </h1>
        <p>
            <time datetime="2011-10-20 00:00:00 &#43;0000 UTC" pubdate="pubdate">Thu, Oct 20, 2011</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2011/what-i-miss-in-vanilla-visual-studio">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2011/what-i-miss-in-vanilla-visual-studio</span>
            </a>
        </p>
    </header>

    <p>For the past week or so I&rsquo;ve gone without any Visual Studio enhancements. No <a href="http://www.jetbrains.com/resharper">ReSharper</a>. No <a href="http://www.devexpress.com/coderush">CodeRush</a>. I knew that I didn&rsquo;t leverage even a fraction of what these tools offer so I wanted to find out what I would miss.</p>

<p>Here&rsquo;s what I&rsquo;m missing the most. In no particular order.</p>

<ol>
<li><p><strong>Detection of errors</strong> <em>before</em> I compile.</p></li>

<li><p><strong>Shortcut for moving a class</strong> to its own file.</p>

<p>I like to build up features in the same file (for speed) and then refactor the classes into their own files later. A tedius process of copy/paste.</p></li>

<li><p><strong>A rename function</strong> that is smart enough to rename the file as well.</p></li>

<li><p><strong>Unit Test debugger.</strong></p>

<p>I don&rsquo;t mind running tests in the NUnit GUI, it even feels faster sometimes, but I miss the ability to step into my tests. I use this feature a lot for exploring APIs.</p></li>

<li><p><strong>Ability to generate constructors.</strong></p>

<p>Especially useful for creating custom exceptions where you want to implement all of the base constructors.</p></li>

<li><p><strong>Fast code snippets.</strong></p>

<p>Visual Studio&rsquo;s built in snippets are functional, but slow to access compared to the alternatives so I ended up not using them. I definitely prefer CodeRush&rsquo;s snippets.</p></li>
</ol>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2011/tortoise-svn-powershell-helper-function">Tortoise SVN PowerShell helper function</a>
            
        </h1>
        <p>
            <time datetime="2011-10-12 00:00:00 &#43;0000 UTC" pubdate="pubdate">Wed, Oct 12, 2011</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2011/tortoise-svn-powershell-helper-function">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2011/tortoise-svn-powershell-helper-function</span>
            </a>
        </p>
    </header>

    <p>Do you work from the command line? Use PowerShell? SVN?</p>

<p>While the SVN command line client is certainly usable, there are definitely times where a GUI is more convenient. Specifically during a commit where you want to easily check/uncheck files and view diffs.</p>

<p>I got tired of having to open an explorer window to get into Tortoise SVN&rsquo;s commit screen so I wrote this helper function.</p>

<p>Put this into your profile and you can start typing <code>tsvn commit</code> (or just <code>tsvn</code>) to open the Tortoise SVN commit dialog. Enjoy!</p>

<pre><code># Helper function for opening the Tortoise SVN GUI from a PowerShell prompt.
# Put this into your PowerShell profile.
# Ensure Tortoise SVN is in your PATH (usually C:\Program Files\TortoiseSVN\bin) 
function Svn-Tortoise([string]$Command = &quot;commit&quot;) {
&lt;#
.SYNOPSIS
  Launches TortoiseSVN with the given command.
  Opens the commit screen if no command is given.
  
  List of supported commands can be found at:
  http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-automation.html
#&gt;
  TortoiseProc.exe /command:$Command /path:&quot;$pwd&quot;
}
Set-Alias tsvn &quot;Svn-Tortoise&quot;
</code></pre>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2011/take-your-powershell-profile-everywhere-with-dropbox">Take your PowerShell profile everywhere with Dropbox</a>
            
        </h1>
        <p>
            <time datetime="2011-03-25 00:00:00 &#43;0000 UTC" pubdate="pubdate">Fri, Mar 25, 2011</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2011/take-your-powershell-profile-everywhere-with-dropbox">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2011/take-your-powershell-profile-everywhere-with-dropbox</span>
            </a>
        </p>
    </header>

    

<p>I&rsquo;ll cover these prerequisites in brief, but for this tip I&rsquo;m going to assume a few things:</p>

<ul>
<li>You are running Windows and have <a href="http://msdn.microsoft.com/en-us/library/aa973757.aspx">PowerShell</a> installed.</li>
<li>You are familiar enough with PowerShell to care about your <a href="http://msdn.microsoft.com/en-us/library/bb613488.aspx">$PROFILE</a>.</li>
</ul>

<h3 id="what-is-powershell:7bb74ac85e0a49464a534530f48431fc">What is PowerShell?</h3>

<p>In short, PowerShell is a new scripting language from Microsoft designed to replace the use of batch files and VBScript for administrating and automating Windows machines. The language leverages the .NET Framework such that anything you can do with .NET you can do with PowerShell. Typically you will be using PowerShell from the command line but there are lots of other ways to use it.</p>

<h3 id="what-is-a-powershell-profile:7bb74ac85e0a49464a534530f48431fc">What is a PowerShell profile?</h3>

<p>PowerShell has the concept of a script that will run each time you launch PowerShell. This is a really handy place to put any functions that you want to be available all the time. Initialize some variables, create some aliases, anything you do here will be there when you need it.</p>

<h3 id="what-are-we-doing-here:7bb74ac85e0a49464a534530f48431fc">What are we doing here?</h3>

<p>I&rsquo;m going to give you one possible solution for keeping all of your scripts and settings (i.e. your profile) in sync no matter which computer you are on. No copy/pasting. No more wearing that USB dongle around your neck - seriously, that just <em>screams</em> geek.</p>

<p>Most steps have a sample PowerShell command that will do the trick. So fire up PowerShell and put on your scripting hat &lsquo;cuz here we go!</p>

<ol>
<li><p><strong><a href="http://db.tt/i03IdN4">Get Dropbox</a>.</strong><br />
Among other things, Dropbox makes keeping your files in sync across computers dead simple. If you aren&rsquo;t using it you should be. It&rsquo;s just that good.</p></li>

<li><p><strong>Create a folder in Dropbox to hold your scripts.</strong></p>

<p><code>PS&gt; New-Item $dropbox\scripts</code></p>

<p><em>Anywhere you see <code>$dropbox</code>, assume this to be the path to your Dropbox folder. By default on Windows 7 this is <code>%USERPROFILE%\Dropbox</code>.</em></p></li>

<li><p><strong>Copy your profile <code>ps1</code> file into your new scripts folder.</strong></p>

<p><code>PS&gt; Copy-Item $PROFILE $dropbox\scripts\profile.ps1</code></p></li>

<li><p><strong>Edit your profile <code>ps1</code> file (the original one) and &ldquo;dot source&rdquo; the one in your Dropbox folder.</strong></p>

<p><code>PS&gt; &quot;. $dropbox\scripts\profile.ps1&quot; &gt; $PROFILE</code></p></li>
</ol>

<p><strong>Pro Tip!</strong> As an alternative to dot sourcing your profile from Dropbox, you could instead <a href="/2012/soft-links-hard-links-junctions-oh-my-symlinks-on-windows/">create a symlink</a> to it.</p>

<pre><code>PS&gt; /cmd /c mklink `&quot;$PROFILE`&quot; `&quot;$dropbox\scripts\profile.ps1`&quot;
</code></pre>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	<div class="row">
<div class="twelve columns">

<article class="post">
    <header>
        <h1>
            
            <a href="/2010/installing-ruby-and-the-devkit-on-windows">Installing Ruby (and the DevKit) on Windows</a>
            
        </h1>
        <p>
            <time datetime="2010-11-11 00:00:00 &#43;0000 UTC" pubdate="pubdate">Thu, Nov 11, 2010</time>
            <span class="symbol">&#8226;</span>
            <a class="permalink" title="Permalink" href="/2010/installing-ruby-and-the-devkit-on-windows">
                <span class="noprint symbol">&#8734;</span>
                <span class="printonly">http://joshua.poehls.me/2010/installing-ruby-and-the-devkit-on-windows</span>
            </a>
        </p>
    </header>

    <p>Here&rsquo;s my recipe for a painfree installation of Ruby on Windows.</p>

<ol>
<li>Use the RubyInstaller from <a href="http://www.ruby-lang.org/en/downloads/">www.ruby-lang.org</a>.
I used Ruby 1.9.2-p0.</li>
<li>Install the Ruby DevKit by following the instructions in the <a href="https://github.com/oneclick/rubyinstaller/wiki/development-kit">Installation Overview</a>.
I used version DevKit-4.5.0-20100819-1536-sfx.</li>
</ol>

<p>The DevKit is needed so that you can install gems that need to build native extensions.
Without it when you try to <code>gem install jekyll</code> you will see an error like this:</p>

<pre><code>ERROR: Error installing jekyll:
ERROR: Failed to build gem native extension.

'make' is not recognized as an internal or external command,
operable program or batch file.
</code></pre>

<p>After installing DevKit <code>gem install jekyll</code> will work like a champ.</p>

<p>Good luck!</p>


</article>

<div class="fin symbol">&#10687;</div>

</div>
</div>
	
	</section>

</div>

<nav class="pagination">

	<a href="/page/4/" aria-label="Earlier Posts"><span aria-hidden="true">&laquo; Earlier Posts</span></a>


	
		&nbsp;&nbsp;
	


	<a href="/page/2/" aria-label="Recent Posts"><span aria-hidden="true">Recent Posts &raquo;</span></a>

</nav>

<footer>
<p>Subscribe to the <a href="/feed.xml">feed</a> to stay up-to-date.</p>
<p>Browse the <a href="/archives">archives</a> if you're bored.</p>
<p>&copy;&nbsp;2014-2015&nbsp;Joshua&nbsp;Poehls.</p>
</footer>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55160531-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>